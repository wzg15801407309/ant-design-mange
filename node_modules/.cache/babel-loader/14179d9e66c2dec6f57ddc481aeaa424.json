{"remainingRequest":"/Users/zhuqin.wei/Desktop/yhy/pangSky-console/node_modules/babel-loader/lib/index.js!/Users/zhuqin.wei/Desktop/yhy/pangSky-console/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/zhuqin.wei/Desktop/yhy/pangSky-console/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/zhuqin.wei/Desktop/yhy/pangSky-console/src/views/userSet/OtherLogin.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/zhuqin.wei/Desktop/yhy/pangSky-console/src/views/userSet/OtherLogin.vue","mtime":1581670424007},{"path":"/Users/zhuqin.wei/Desktop/yhy/pangSky-console/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhuqin.wei/Desktop/yhy/pangSky-console/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/zhuqin.wei/Desktop/yhy/pangSky-console/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhuqin.wei/Desktop/yhy/pangSky-console/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es7.object.get-own-property-descriptors\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.object.keys\";\nimport \"core-js/modules/es6.function.name\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"/Users/zhuqin.wei/Desktop/yhy/pangSky-console/node_modules/@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"/Users/zhuqin.wei/Desktop/yhy/pangSky-console/node_modules/@babel/runtime-corejs2/helpers/esm/defineProperty\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { mapActions } from 'vuex';\nimport { login, getUserInfo, platformLogin, changeUsername } from '@/api/login';\nimport { initOtherLogin, loginFromFacebook } from '@/utils/OtherLogin';\nexport default {\n  props: {\n    oldUserInfo: Object\n  },\n  data: function data() {\n    return {\n      timeout: null,\n      initOtherLogin: initOtherLogin,\n      loginFromFacebook: loginFromFacebook\n    };\n  },\n  methods: _objectSpread({}, mapActions(['SetToken', 'SetUserInfo']), {\n    loginSuccess: function loginSuccess() {\n      // 正常登陆\n      this.$router.push({\n        name: 'index'\n      });\n      this.$notification.success({\n        message: this.$t('login.welcome'),\n        description: \"\".concat(this.$utils.timeFix(this.$t('welcome')), \" \").concat(this.$t('login.welcomeBack'))\n      });\n    },\n    handlePlantFormLogin: function () {\n      var _handlePlantFormLogin = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee(type, _ref) {\n        var _this2 = this;\n\n        var id, typeId;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                id = _ref.id;\n                typeId = {\n                  id: id,\n                  type: type + 'Id'\n                };\n\n                if (typeId.id) {\n                  changeUsername(_defineProperty({}, typeId.type, typeId.id), this.oldUserInfo.id).then(function (res) {\n                    _this2.SetToken(res.body);\n\n                    getUserInfo().then(function (res) {\n                      if (res.state) {\n                        _this2.SetUserInfo(res.body);\n\n                        window.location.reload();\n                      }\n                    });\n                  });\n                }\n\n              case 3:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function handlePlantFormLogin(_x, _x2) {\n        return _handlePlantFormLogin.apply(this, arguments);\n      }\n\n      return handlePlantFormLogin;\n    }(),\n    //其他的登录方式\n    feacebookLogin: function () {\n      var _feacebookLogin = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee3() {\n        var _this3 = this;\n\n        return regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                FB.login(function (response) {\n                  if (response.authResponse) {\n                    FB.api('/me',\n                    /*#__PURE__*/\n                    function () {\n                      var _ref2 = _asyncToGenerator(\n                      /*#__PURE__*/\n                      regeneratorRuntime.mark(function _callee2(response) {\n                        var id, name, email;\n                        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n                          while (1) {\n                            switch (_context2.prev = _context2.next) {\n                              case 0:\n                                id = response.id, name = response.name, email = response.email;\n\n                                _this3.handlePlantFormLogin('facebook', {\n                                  id: id,\n                                  name: name,\n                                  email: email\n                                });\n\n                              case 2:\n                              case \"end\":\n                                return _context2.stop();\n                            }\n                          }\n                        }, _callee2);\n                      }));\n\n                      return function (_x3) {\n                        return _ref2.apply(this, arguments);\n                      };\n                    }());\n                  } else {\n                    console.log('User cancelled login or did not fully authorize.');\n                  }\n                });\n\n              case 1:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3);\n      }));\n\n      function feacebookLogin() {\n        return _feacebookLogin.apply(this, arguments);\n      }\n\n      return feacebookLogin;\n    }(),\n    cancelbind: function cancelbind(type) {\n      var This = this;\n      this.$confirm({\n        title: this.$t('common.cancelbind'),\n        onOk: function onOk() {\n          changeUsername(_defineProperty({}, type, \"\"), This.oldUserInfo.id).then(function (res) {\n            This.SetToken(res.body);\n            getUserInfo().then(function (res) {\n              if (res.state) {\n                This.SetUserInfo(res.body);\n                window.location.reload();\n              }\n            });\n          });\n        }\n      });\n    },\n    // 定时器初始化\n    settime: function settime() {\n      // 验证 路由参数\n      this.initOtherLogin(this.handlePlantFormLogin);\n      clearTimeout(this.timeout);\n\n      var _this = this;\n\n      _this.timeout = setTimeout(function () {\n        _this.settime();\n      }, 1000);\n    }\n  }),\n  beforeDestroy: function beforeDestroy() {\n    clearTimeout(this.timeout);\n  },\n  mounted: function mounted() {\n    //实例化 第三方登陆 Facebook google。。。。\n    this.settime();\n  }\n};",{"version":3,"sources":["OtherLogin.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div class=\"userSetOtherLogin\">\n    <div class=\"user-login-other1\">\n      <!-- oldUserInfo.facebookId -->\n      <div\n        v-if=\"oldUserInfo.facebookId\"\n        class=\"fcebook log\"\n        @click=\"cancelbind('facebookId')\"\n      >\n        <img src=\"@/assets/icon/facebook1.png\" alt=\"\" />\n      </div>\n      <div v-else class=\"fcebook log\" @click=\"feacebookLogin\">\n        <img src=\"@/assets/icon/facebook.png\" alt=\"\" />\n      </div>\n      <!-- oldUserInfo.googleId -->\n      <div\n        v-if=\"oldUserInfo.googleId\"\n        @click=\"cancelbind('googleId')\"\n        class=\"google log\"\n      >\n        <img src=\"@/assets/icon/google1.png\" alt=\"\" />\n      </div>\n      <div v-else class=\"google log\" id=\"GOOGLE_BTN\">\n        <img src=\"@/assets/icon/google.png\" alt=\"\" />\n      </div>\n      <!-- oldUserInfo.naverId -->\n      <div\n        v-if=\"oldUserInfo.naverId\"\n        @click=\"cancelbind('naverId')\"\n        class=\"naverIdLogin naverH log\"\n      ></div>\n      <div v-else id=\"naverIdLogin\" class=\"naverIdLogin naverN log\"></div>\n    </div>\n  </div>\n</template>\n<script>\nimport { mapActions } from 'vuex'\nimport { login, getUserInfo, platformLogin, changeUsername } from '@/api/login'\nimport { initOtherLogin, loginFromFacebook } from '@/utils/OtherLogin'\nexport default {\n  props: {\n    oldUserInfo: Object\n  },\n  data() {\n    return { \n      timeout: null,\n      initOtherLogin,\n      loginFromFacebook\n    }\n  },\n  methods: {\n    ...mapActions(['SetToken', 'SetUserInfo']),\n    loginSuccess() {\n      // 正常登陆\n      this.$router.push({ name: 'index' })\n      this.$notification.success({\n        message: this.$t('login.welcome'),\n        description: `${this.$utils.timeFix(this.$t('welcome'))} ${this.$t(\n          'login.welcomeBack'\n        )}`\n      })\n    },\n    async handlePlantFormLogin(type, { id }) {\n      const typeId = {\n        id,\n        type: type + 'Id'\n      }\n      if (typeId.id) { \n        changeUsername({ [typeId.type]: typeId.id }, this.oldUserInfo.id).then(\n          res => { \n            this.SetToken(res.body)\n            getUserInfo().then(res => {\n              if (res.state) {\n                this.SetUserInfo(res.body)\n                window.location.reload()\n              }\n            })\n          }\n        )\n      }\n    },\n    //其他的登录方式\n    async feacebookLogin() {\n      FB.login(response => {\n        if (response.authResponse) {\n          FB.api('/me', async response => {\n            const { id, name, email } = response\n            this.handlePlantFormLogin('facebook', {\n              id,\n              name,\n              email\n            })\n          })\n        } else {\n          console.log('User cancelled login or did not fully authorize.')\n        }\n      })\n    },\n    cancelbind(type) {\n      const This = this\n      this.$confirm({ \n        title:  this.$t('common.cancelbind'),\n        onOk() {\n          changeUsername({ [type]: \"\" }, This.oldUserInfo.id).then(res => { \n            This.SetToken(res.body)\n            getUserInfo().then(res => {\n              if (res.state) {\n                This.SetUserInfo(res.body)\n                window.location.reload()\n              }\n            })\n          })\n        }\n      })\n    },\n    // 定时器初始化\n    settime() {\n      // 验证 路由参数\n      this.initOtherLogin(this.handlePlantFormLogin)\n      clearTimeout(this.timeout)\n      const _this = this\n      _this.timeout = setTimeout(() => {\n        _this.settime()\n      }, 1000)\n    }\n  },\n  beforeDestroy() {\n    clearTimeout(this.timeout)\n  },\n  mounted() {\n    //实例化 第三方登陆 Facebook google。。。。\n    this.settime()\n  }\n}\n</script>\n<style lang=\"less\">\n.userSetOtherLogin {\n  width: 280px;\n}\n.user-login-other1 {\n  display: flex;\n  justify-content: flex-start;\n  div {\n    img {\n      width: 100%;\n      &:hover {\n        cursor: pointer;\n      }\n    }\n  }\n  .log {\n    margin-left: 10px;\n    line-height: 34px;\n    width: 34px;\n    height: 34px;\n  }\n}\n</style>\n"],"sourceRoot":"src/views/userSet"}]}