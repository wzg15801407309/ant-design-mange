{"remainingRequest":"/Users/zhuqin.wei/Desktop/yhy/pangSky-console/node_modules/babel-loader/lib/index.js!/Users/zhuqin.wei/Desktop/yhy/pangSky-console/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/zhuqin.wei/Desktop/yhy/pangSky-console/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/zhuqin.wei/Desktop/yhy/pangSky-console/src/views/login/OtherLogin.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/zhuqin.wei/Desktop/yhy/pangSky-console/src/views/login/OtherLogin.vue","mtime":1582608290247},{"path":"/Users/zhuqin.wei/Desktop/yhy/pangSky-console/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhuqin.wei/Desktop/yhy/pangSky-console/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/zhuqin.wei/Desktop/yhy/pangSky-console/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhuqin.wei/Desktop/yhy/pangSky-console/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es7.object.get-own-property-descriptors\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.object.keys\";\nimport \"core-js/modules/es6.function.name\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"/Users/zhuqin.wei/Desktop/yhy/pangSky-console/node_modules/@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"/Users/zhuqin.wei/Desktop/yhy/pangSky-console/node_modules/@babel/runtime-corejs2/helpers/esm/defineProperty\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { mapActions } from 'vuex';\nimport { login, getUserInfo, platformLogin } from '@/api/login';\nimport { initOtherLogin, loginFromFacebook } from \"./OtherLogin\";\nexport default {\n  data: function data() {\n    return {\n      timeout: null,\n      initOtherLogin: initOtherLogin,\n      loginFromFacebook: loginFromFacebook\n    };\n  },\n  methods: _objectSpread({}, mapActions(['SetToken', 'SetUserInfo']), {\n    loginSuccess: function loginSuccess() {\n      // 正常登陆\n      this.$router.push({\n        name: 'index'\n      });\n      this.$notification.success({\n        message: this.$t('login.welcome'),\n        description: \"\".concat(this.$utils.timeFix(this.$t('welcome')), \" \").concat(this.$t('login.welcomeBack'))\n      });\n    },\n    handlePlantFormLogin: function () {\n      var _handlePlantFormLogin = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee(type, _ref) {\n        var _this2 = this;\n\n        var id, email, name, head;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                id = _ref.id, email = _ref.email, name = _ref.name, head = _ref.head;\n                this.$emit('changeloading');\n\n                if (type == 'facebook') {\n                  email = '';\n                  head = '';\n                } // username和password\n\n\n                platformLogin({\n                  plantform: type,\n                  id: id,\n                  email: email,\n                  head: head,\n                  username: name,\n                  password: email\n                }).then(function (res) {\n                  if (res.state) {\n                    _this2.SetToken(res.body);\n\n                    getUserInfo().then(function (res) {\n                      if (res.state) {\n                        _this2.SetUserInfo(res.body); // 登陆成功\n\n\n                        _this2.loginSuccess();\n                      }\n                    });\n                  } else {\n                    //除了naver 没有注册，携带参数跳转\n                    if (type != 'nvaer') {\n                      window.location.href = \"/register?type=\".concat(type, \"&id=\").concat(id, \"&email=\").concat(email, \"&name=\").concat(name, \"&head=\").concat(head);\n                    }\n                  }\n                });\n\n              case 4:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function handlePlantFormLogin(_x, _x2) {\n        return _handlePlantFormLogin.apply(this, arguments);\n      }\n\n      return handlePlantFormLogin;\n    }(),\n    //其他的登录方式\n    feacebookLogin: function () {\n      var _feacebookLogin = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee3() {\n        var _this3 = this;\n\n        return regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                FB.login(function (response) {\n                  if (response.authResponse) {\n                    FB.api('/me',\n                    /*#__PURE__*/\n                    function () {\n                      var _ref2 = _asyncToGenerator(\n                      /*#__PURE__*/\n                      regeneratorRuntime.mark(function _callee2(response) {\n                        var id, name, email;\n                        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n                          while (1) {\n                            switch (_context2.prev = _context2.next) {\n                              case 0:\n                                id = response.id, name = response.name, email = response.email;\n\n                                _this3.handlePlantFormLogin('facebook', {\n                                  id: id,\n                                  name: name,\n                                  email: email\n                                });\n\n                              case 2:\n                              case \"end\":\n                                return _context2.stop();\n                            }\n                          }\n                        }, _callee2);\n                      }));\n\n                      return function (_x3) {\n                        return _ref2.apply(this, arguments);\n                      };\n                    }());\n                  } else {\n                    console.log('User cancelled login or did not fully authorize.');\n                  }\n                });\n\n              case 1:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3);\n      }));\n\n      function feacebookLogin() {\n        return _feacebookLogin.apply(this, arguments);\n      }\n\n      return feacebookLogin;\n    }(),\n    // 定时器初始化\n    settime: function settime() {\n      // 验证 路由参数\n      this.initOtherLogin(this.handlePlantFormLogin, this.$emit);\n      clearTimeout(this.timeout);\n\n      var _this = this;\n\n      _this.timeout = setTimeout(function () {\n        _this.settime();\n      }, 1000);\n    }\n  }),\n  beforeDestroy: function beforeDestroy() {\n    clearTimeout(this.timeout);\n  },\n  created: function created() {\n    if (this.$route.hash.indexOf('access_token') != -1) {\n      this.$emit('changeloading');\n    }\n  },\n  mounted: function mounted() {\n    //实例化 第三方登陆 Facebook google。。。。\n    this.settime();\n  }\n};",{"version":3,"sources":["OtherLogin.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div>\n    <a-divider style=\"color:#666;margin:30px 0 20px;font-size:12px\">\n      {{ $t('login.cooperationLogin') }}</a-divider\n    >\n    <div class=\"user-login-other\">\n      <div class=\"fcebook\" @click=\"feacebookLogin(handlePlantFormLogin)\">\n        <img src=\"@/assets/facebook.png\" alt=\"\" />\n      </div>\n      <div class=\"google\" id=\"GOOGLE_BTN\">\n        <img src=\"@/assets/google.png\" alt=\"\" />\n      </div>\n      <div id=\"naverIdLogin\" class=\"naverIdLogin1\"></div>\n    </div>\n  </div>\n</template>\n<script>\nimport { mapActions } from 'vuex'\nimport { login, getUserInfo, platformLogin } from '@/api/login'\nimport { initOtherLogin, loginFromFacebook } from './OtherLogin'\nexport default {\n  data() {\n    return {\n      timeout: null,\n      initOtherLogin,\n      loginFromFacebook\n    }\n  },\n  methods: {\n    ...mapActions(['SetToken', 'SetUserInfo']),\n    loginSuccess() {\n      // 正常登陆\n      this.$router.push({ name: 'index' })\n      this.$notification.success({\n        message: this.$t('login.welcome'),\n        description: `${this.$utils.timeFix(this.$t('welcome'))} ${this.$t(\n          'login.welcomeBack'\n        )}`\n      })\n    },\n    async handlePlantFormLogin(type, { id, email, name, head }) {\n      this.$emit('changeloading')\n      if (type == 'facebook') {\n        email = ''\n        head = ''\n      }\n      // username和password\n      platformLogin({\n        plantform: type,\n        id,\n        email,\n        head,\n        username: name,\n        password: email\n      }).then(res => {\n        if (res.state) {\n          this.SetToken(res.body)\n          getUserInfo().then(res => {\n            if (res.state) {\n              this.SetUserInfo(res.body)\n              // 登陆成功\n              this.loginSuccess()\n            }\n          })\n        } else {\n          //除了naver 没有注册，携带参数跳转\n          if (type != 'nvaer') {\n            window.location.href = `/register?type=${type}&id=${id}&email=${email}&name=${name}&head=${head}`\n          }\n        }\n      })\n    },\n    //其他的登录方式\n    async feacebookLogin() {\n      FB.login(response => {\n        if (response.authResponse) {\n          FB.api('/me', async response => {\n            const { id, name, email } = response\n            this.handlePlantFormLogin('facebook', {\n              id,\n              name,\n              email\n            })\n          })\n        } else {\n          console.log('User cancelled login or did not fully authorize.')\n        }\n      })\n    },\n\n    // 定时器初始化\n    settime() {\n      // 验证 路由参数\n      this.initOtherLogin(this.handlePlantFormLogin, this.$emit)\n      clearTimeout(this.timeout)\n      const _this = this\n      _this.timeout = setTimeout(() => {\n        _this.settime()\n      }, 1000)\n    }\n  },\n  beforeDestroy() {\n    clearTimeout(this.timeout)\n  },\n  created(){\n     if (this.$route.hash.indexOf('access_token') != -1) {\n      this.$emit('changeloading')\n    } \n  },\n  mounted() {\n   \n    //实例化 第三方登陆 Facebook google。。。。\n    this.settime()\n  }\n}\n</script>\n<style lang=\"less\">\n.user-login-other {\n  display: flex;\n  justify-content: space-between;\n  div {\n    width: 31%;\n    img {\n      width: 100%;\n      &:hover {\n        cursor: pointer;\n      }\n    }\n  }\n}\n</style>\n"],"sourceRoot":"src/views/login"}]}