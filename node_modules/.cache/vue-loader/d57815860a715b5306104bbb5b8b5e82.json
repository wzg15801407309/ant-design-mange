{"remainingRequest":"/Users/zhuqin.wei/Desktop/yhy/pangSky-console/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/zhuqin.wei/Desktop/yhy/pangSky-console/src/views/userSet/OtherLogin.vue?vue&type=style&index=0&lang=less&","dependencies":[{"path":"/Users/zhuqin.wei/Desktop/yhy/pangSky-console/src/views/userSet/OtherLogin.vue","mtime":1581670424007},{"path":"/Users/zhuqin.wei/Desktop/yhy/pangSky-console/node_modules/css-loader/index.js","mtime":499162500000},{"path":"/Users/zhuqin.wei/Desktop/yhy/pangSky-console/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/zhuqin.wei/Desktop/yhy/pangSky-console/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/zhuqin.wei/Desktop/yhy/pangSky-console/node_modules/less-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhuqin.wei/Desktop/yhy/pangSky-console/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhuqin.wei/Desktop/yhy/pangSky-console/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.userSetOtherLogin {\n  width: 280px;\n}\n.user-login-other1 {\n  display: flex;\n  justify-content: flex-start;\n  div {\n    img {\n      width: 100%;\n      &:hover {\n        cursor: pointer;\n      }\n    }\n  }\n  .log {\n    margin-left: 10px;\n    line-height: 34px;\n    width: 34px;\n    height: 34px;\n  }\n}\n",{"version":3,"sources":["OtherLogin.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"OtherLogin.vue","sourceRoot":"src/views/userSet","sourcesContent":["<template>\n  <div class=\"userSetOtherLogin\">\n    <div class=\"user-login-other1\">\n      <!-- oldUserInfo.facebookId -->\n      <div\n        v-if=\"oldUserInfo.facebookId\"\n        class=\"fcebook log\"\n        @click=\"cancelbind('facebookId')\"\n      >\n        <img src=\"@/assets/icon/facebook1.png\" alt=\"\" />\n      </div>\n      <div v-else class=\"fcebook log\" @click=\"feacebookLogin\">\n        <img src=\"@/assets/icon/facebook.png\" alt=\"\" />\n      </div>\n      <!-- oldUserInfo.googleId -->\n      <div\n        v-if=\"oldUserInfo.googleId\"\n        @click=\"cancelbind('googleId')\"\n        class=\"google log\"\n      >\n        <img src=\"@/assets/icon/google1.png\" alt=\"\" />\n      </div>\n      <div v-else class=\"google log\" id=\"GOOGLE_BTN\">\n        <img src=\"@/assets/icon/google.png\" alt=\"\" />\n      </div>\n      <!-- oldUserInfo.naverId -->\n      <div\n        v-if=\"oldUserInfo.naverId\"\n        @click=\"cancelbind('naverId')\"\n        class=\"naverIdLogin naverH log\"\n      ></div>\n      <div v-else id=\"naverIdLogin\" class=\"naverIdLogin naverN log\"></div>\n    </div>\n  </div>\n</template>\n<script>\nimport { mapActions } from 'vuex'\nimport { login, getUserInfo, platformLogin, changeUsername } from '@/api/login'\nimport { initOtherLogin, loginFromFacebook } from '@/utils/OtherLogin'\nexport default {\n  props: {\n    oldUserInfo: Object\n  },\n  data() {\n    return { \n      timeout: null,\n      initOtherLogin,\n      loginFromFacebook\n    }\n  },\n  methods: {\n    ...mapActions(['SetToken', 'SetUserInfo']),\n    loginSuccess() {\n      // 正常登陆\n      this.$router.push({ name: 'index' })\n      this.$notification.success({\n        message: this.$t('login.welcome'),\n        description: `${this.$utils.timeFix(this.$t('welcome'))} ${this.$t(\n          'login.welcomeBack'\n        )}`\n      })\n    },\n    async handlePlantFormLogin(type, { id }) {\n      const typeId = {\n        id,\n        type: type + 'Id'\n      }\n      if (typeId.id) { \n        changeUsername({ [typeId.type]: typeId.id }, this.oldUserInfo.id).then(\n          res => { \n            this.SetToken(res.body)\n            getUserInfo().then(res => {\n              if (res.state) {\n                this.SetUserInfo(res.body)\n                window.location.reload()\n              }\n            })\n          }\n        )\n      }\n    },\n    //其他的登录方式\n    async feacebookLogin() {\n      FB.login(response => {\n        if (response.authResponse) {\n          FB.api('/me', async response => {\n            const { id, name, email } = response\n            this.handlePlantFormLogin('facebook', {\n              id,\n              name,\n              email\n            })\n          })\n        } else {\n          console.log('User cancelled login or did not fully authorize.')\n        }\n      })\n    },\n    cancelbind(type) {\n      const This = this\n      this.$confirm({ \n        title:  this.$t('common.cancelbind'),\n        onOk() {\n          changeUsername({ [type]: \"\" }, This.oldUserInfo.id).then(res => { \n            This.SetToken(res.body)\n            getUserInfo().then(res => {\n              if (res.state) {\n                This.SetUserInfo(res.body)\n                window.location.reload()\n              }\n            })\n          })\n        }\n      })\n    },\n    // 定时器初始化\n    settime() {\n      // 验证 路由参数\n      this.initOtherLogin(this.handlePlantFormLogin)\n      clearTimeout(this.timeout)\n      const _this = this\n      _this.timeout = setTimeout(() => {\n        _this.settime()\n      }, 1000)\n    }\n  },\n  beforeDestroy() {\n    clearTimeout(this.timeout)\n  },\n  mounted() {\n    //实例化 第三方登陆 Facebook google。。。。\n    this.settime()\n  }\n}\n</script>\n<style lang=\"less\">\n.userSetOtherLogin {\n  width: 280px;\n}\n.user-login-other1 {\n  display: flex;\n  justify-content: flex-start;\n  div {\n    img {\n      width: 100%;\n      &:hover {\n        cursor: pointer;\n      }\n    }\n  }\n  .log {\n    margin-left: 10px;\n    line-height: 34px;\n    width: 34px;\n    height: 34px;\n  }\n}\n</style>\n"]}]}