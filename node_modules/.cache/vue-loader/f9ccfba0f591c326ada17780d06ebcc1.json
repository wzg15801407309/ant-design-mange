{"remainingRequest":"/Users/zhuqin.wei/Desktop/yhy/pangSky-console/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/zhuqin.wei/Desktop/yhy/pangSky-console/src/views/projectAuth/module/ModalForm.vue?vue&type=style&index=0&lang=less&","dependencies":[{"path":"/Users/zhuqin.wei/Desktop/yhy/pangSky-console/src/views/projectAuth/module/ModalForm.vue","mtime":1581057012341},{"path":"/Users/zhuqin.wei/Desktop/yhy/pangSky-console/node_modules/css-loader/index.js","mtime":499162500000},{"path":"/Users/zhuqin.wei/Desktop/yhy/pangSky-console/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/zhuqin.wei/Desktop/yhy/pangSky-console/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/zhuqin.wei/Desktop/yhy/pangSky-console/node_modules/less-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhuqin.wei/Desktop/yhy/pangSky-console/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhuqin.wei/Desktop/yhy/pangSky-console/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\n.ModalForm {\r\n  .title {\r\n    font-size: 16px;\r\n    font-weight: bold;\r\n  }\r\n  .addButton {\r\n    margin-bottom: 20px;\r\n  }\r\n}\r\n",{"version":3,"sources":["ModalForm.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0HA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ModalForm.vue","sourceRoot":"src/views/projectAuth/module","sourcesContent":["<template>\r\n  <div class=\"ModalForm\">\r\n    <a-button class=\"addButton\" type=\"primary\" @click=\"showModal\">{{\r\n      $t('project.add')\r\n    }}</a-button>\r\n    <a-modal\r\n      :title=\"$t('project.add')\"\r\n      :visible=\"visible\"\r\n      @ok=\"handleOk\"\r\n      :confirmLoading=\"confirmLoading\"\r\n      @cancel=\"handleCancel\"\r\n    >\r\n      <h3 class=\"title\">{{ $t('project.user') }}:</h3>\r\n      <a-input :placeholder=\"$t('user.inEmail')\" v-model=\"formData.username\" />\r\n      <h3 class=\"title\">{{ $t('project.auth') }}:</h3>\r\n      <a-select\r\n        style=\"width:100%\"\r\n        :placeholder=\"$t('project.changeauth')\"\r\n        @change=\"handleSelectChange\"\r\n      >\r\n        <a-select-option value=\"1\">\r\n          {{ $t('project.management') }}\r\n        </a-select-option>\r\n        <a-select-option value=\"2\">\r\n          {{ $t('project.operators') }}\r\n        </a-select-option>\r\n        <a-select-option value=\"3\">\r\n          {{ $t('project.maintainers') }}\r\n        </a-select-option>\r\n      </a-select>\r\n    </a-modal>\r\n  </div>\r\n</template>\r\n<script>\r\nimport { checkUsernameIsHave } from '@/api/login'\r\n\r\nimport { putPowerIitem } from '@/api/power'\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      visible: false,\r\n      confirmLoading: false,\r\n      isEmailOk: null,\r\n      formData: {\r\n        username: '',\r\n        level: null,\r\n        id: null\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    showModal() {\r\n      this.visible = true\r\n    },\r\n    async handleOk() {\r\n      this.confirmLoading = true\r\n      const res = await checkUsernameIsHave(this.formData.username)\r\n      if (res.body) {\r\n        this.formData.id = res.body.id\r\n      } else {\r\n        this.$notification.error({\r\n          message: this.$t('common.error'),\r\n          description:this.$t('project.nouser'),\r\n        })\r\n        this.confirmLoading = false\r\n        return false\r\n      }\r\n      if (!this.formData.level) {\r\n        this.$notification.error({\r\n          message: this.$t('common.error'),\r\n          description: this.$t('project.ischangeauth'),\r\n        })\r\n        this.confirmLoading = false\r\n        return false\r\n      }\r\n      const data = {\r\n        pid: this.$route.params.name,\r\n        uid: this.formData.id,\r\n        level: this.formData.level\r\n      }\r\n      this.confirmLoading = true\r\n      putPowerIitem(data).then(res => {\r\n        this.confirmLoading = false\r\n        if (res.state) {\r\n          this.handleCancel()\r\n          this.$notification.success({\r\n            message:this.$t('common.success'),\r\n            description: this.$t('project.success'),\r\n          })\r\n        } else {\r\n          this.$notification.error({\r\n            message: this.$t('common.error'),\r\n            description: res.body\r\n          })\r\n        }\r\n      })\r\n    },\r\n    onSearch(e) {\r\n      checkUsernameIsHave(e).then(res => {\r\n        if (res.body) {\r\n          this.isEmailOk = res.body\r\n        }\r\n      })\r\n    },\r\n    ///\r\n    handleCancel() {\r\n      this.visible = false\r\n      this.formData = {\r\n        username: '',\r\n        level: null,\r\n        id: null\r\n      }\r\n    },\r\n    handleSelectChange(value) {\r\n      this.formData.level = value\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\">\r\n.ModalForm {\r\n  .title {\r\n    font-size: 16px;\r\n    font-weight: bold;\r\n  }\r\n  .addButton {\r\n    margin-bottom: 20px;\r\n  }\r\n}\r\n</style>\r\n"]}]}