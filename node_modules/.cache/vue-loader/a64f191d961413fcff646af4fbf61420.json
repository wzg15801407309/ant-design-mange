{"remainingRequest":"/Users/zhuqin.wei/Desktop/yhy/pangSky-console/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/zhuqin.wei/Desktop/yhy/pangSky-console/src/views/login/OtherLogin.vue?vue&type=style&index=0&lang=less&","dependencies":[{"path":"/Users/zhuqin.wei/Desktop/yhy/pangSky-console/src/views/login/OtherLogin.vue","mtime":1581057012335},{"path":"/Users/zhuqin.wei/Desktop/yhy/pangSky-console/node_modules/css-loader/index.js","mtime":499162500000},{"path":"/Users/zhuqin.wei/Desktop/yhy/pangSky-console/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/zhuqin.wei/Desktop/yhy/pangSky-console/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/zhuqin.wei/Desktop/yhy/pangSky-console/node_modules/less-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhuqin.wei/Desktop/yhy/pangSky-console/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhuqin.wei/Desktop/yhy/pangSky-console/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.user-login-other {\n  display: flex;\n  justify-content: space-between;\n  div {\n    width: 31%;\n    img {\n      width: 100%;\n      &:hover {\n        cursor: pointer;\n      }\n    }\n  }\n}\n",{"version":3,"sources":["OtherLogin.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"OtherLogin.vue","sourceRoot":"src/views/login","sourcesContent":["<template>\n  <div>\n    <a-divider style=\"color:#666;margin:30px 0 20px;font-size:12px\">\n      {{ $t('login.cooperationLogin') }}</a-divider\n    >\n    <div class=\"user-login-other\">\n      <div class=\"fcebook\" @click=\"feacebookLogin(handlePlantFormLogin)\">\n        <img src=\"@/assets/facebook.png\" alt=\"\" />\n      </div>\n      <div class=\"google\" id=\"GOOGLE_BTN\">\n        <img src=\"@/assets/google.png\" alt=\"\" />\n      </div>\n      <div id=\"naverIdLogin\"></div>\n    </div>\n  </div>\n</template>\n<script>\nimport { mapActions } from 'vuex'\nimport { login, getUserInfo, platformLogin } from '@/api/login'\nimport { initOtherLogin, loginFromFacebook } from '@/utils/OtherLogin'\nexport default {\n  data() {\n    return {\n      timeout: null,\n      initOtherLogin,\n      loginFromFacebook\n    }\n  },\n  methods: {\n    ...mapActions(['SetToken', 'SetUserInfo']),\n    loginSuccess() {\n      // 正常登陆\n      this.$router.push({ name: 'index' })\n      this.$notification.success({\n        message: this.$t('login.welcome'),\n        description: `${this.$utils.timeFix(this.$t('welcome'))} ${this.$t(\n          'login.welcomeBack'\n        )}`\n      })\n    },\n    async handlePlantFormLogin(type, { id, email, name, head }) {\n      \n      if (type == 'facebook') {\n        email = ''\n        head = ''\n      }\n      platformLogin({\n        plantform: type,\n        id,\n        email,\n        head\n      }).then(res => {\n        if (res.state) {\n          this.SetToken(res.body)\n          getUserInfo().then(res => {\n            if (res.state) {\n              this.SetUserInfo(res.body)\n              // 登陆成功\n              this.loginSuccess()\n            }\n          })\n        } else {\n          window.location.href = `/register?type=${type}&id=${id}&email=${email}&name=${name}&head=${head}`\n          //没有注册，携带参数跳转\n        }\n      })\n    },\n    //其他的登录方式\n    async feacebookLogin() {\n      FB.login(response => {\n        if (response.authResponse) {\n          FB.api('/me', async response => {\n            const { id, name, email } = response\n            this.handlePlantFormLogin('facebook', {\n              id,\n              name,\n              email\n            })\n          })\n        } else {\n          console.log('User cancelled login or did not fully authorize.')\n        }\n      })\n    },\n\n    // 定时器初始化\n    settime() {\n      // 验证 路由参数\n      this.initOtherLogin(this.handlePlantFormLogin)\n      clearTimeout(this.timeout)\n      const _this = this\n      _this.timeout = setTimeout(() => {\n        _this.settime()\n      }, 1000)\n    }\n  },\n  beforeDestroy() {\n    clearTimeout(this.timeout)\n  },\n  mounted() {\n    //实例化 第三方登陆 Facebook google。。。。\n    this.settime()\n  }\n}\n</script>\n<style lang=\"less\">\n.user-login-other {\n  display: flex;\n  justify-content: space-between;\n  div {\n    width: 31%;\n    img {\n      width: 100%;\n      &:hover {\n        cursor: pointer;\n      }\n    }\n  }\n}\n</style>\n"]}]}