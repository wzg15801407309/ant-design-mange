{"remainingRequest":"/Users/zhuqin.wei/Desktop/yhy/pangSky-console/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/zhuqin.wei/Desktop/yhy/pangSky-console/src/views/userSet/index.vue?vue&type=style&index=0&id=41356cb0&lang=less&scoped=true&","dependencies":[{"path":"/Users/zhuqin.wei/Desktop/yhy/pangSky-console/src/views/userSet/index.vue","mtime":1582634015563},{"path":"/Users/zhuqin.wei/Desktop/yhy/pangSky-console/node_modules/css-loader/index.js","mtime":499162500000},{"path":"/Users/zhuqin.wei/Desktop/yhy/pangSky-console/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/zhuqin.wei/Desktop/yhy/pangSky-console/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/zhuqin.wei/Desktop/yhy/pangSky-console/node_modules/less-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhuqin.wei/Desktop/yhy/pangSky-console/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhuqin.wei/Desktop/yhy/pangSky-console/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\n.user-settings-info-view {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  .content {\r\n    /deep/.ant-form-item-label label {\r\n      color: #9d9d9e;\r\n    }\r\n    .ant-input {\r\n      color: #9d9d9e;\r\n      border-radius: 4px;\r\n      background: #f4f4f4;\r\n      &:focus {\r\n        background: #fff;\r\n      }\r\n    }\r\n    .p-user {\r\n      font-size: 16px !important;\r\n      font-weight: 400 !important;\r\n      line-height: 22px !important;\r\n      color: #454442 !important;\r\n    }\r\n    /deep/.ant-calendar-picker-input {\r\n      background: #f4f4f4;\r\n      color: #9d9d9e;\r\n      border-radius: 4px;\r\n      &:focus {\r\n        background: #fff;\r\n      }\r\n    }\r\n  }\r\n}\r\n",{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/userSet","sourcesContent":["<template>\r\n  <div class=\"user-settings-info-view\">\r\n    <div class=\"content\">\r\n      <a-card style=\"width: 1200px; margin-top:30px\">\r\n        <a-form>\r\n          <a-form-item :label-col=\"labelCol\" :wrapper-col=\"wrapperCol\">\r\n            <span slot=\"label\" class=\"p-user\">{{ $t('user.mySet') }}</span>\r\n          </a-form-item>\r\n          <a-form-item\r\n            :label-col=\"labelCol\"\r\n            :wrapper-col=\"wrapperCol\"\r\n            :label=\"$t('user.emailset')\"\r\n          >\r\n            {{ oldUserInfo.username }}\r\n          </a-form-item>\r\n            <a-form-item\r\n            :label-col=\"labelCol\"\r\n            :wrapper-col=\"wrapperCol\"\r\n            :label=\"$t('common.thirdparty')\"\r\n          >\r\n            <OtherLogin :oldUserInfo=\"oldUserInfo\" />\r\n          </a-form-item> \r\n          <a-form-item\r\n            :label-col=\"labelCol\"\r\n            :wrapper-col=\"wrapperCol\"\r\n            :label=\"$t('user.borthday')\"\r\n            has-feedback\r\n          >\r\n            <a-date-picker\r\n              v-if=\"oldUserInfo.birthday\"\r\n              style=\"width: 100%\"\r\n              @change=\"onTimeChange\"\r\n              :defaultValue=\"moment(oldUserInfo.birthday, 'YYYY-MM-DD')\"\r\n              format=\"YYYY-MM-DD\"\r\n            />\r\n            <a-date-picker\r\n              v-else\r\n              style=\"width: 100%\"\r\n              @change=\"onTimeChange\"\r\n              format=\"YYYY-MM-DD\"\r\n            />\r\n          </a-form-item>\r\n          <a-form-item\r\n            :label-col=\"labelCol\"\r\n            :wrapper-col=\"wrapperCol\"\r\n            :label=\"$t('user.sex')\"\r\n          >\r\n            <a-radio-group v-model=\"oldUserInfo.sex\">\r\n              <a-radio :value=\"1\">{{ $t('user.man') }}</a-radio>\r\n              <a-radio :value=\"2\">{{ $t('user.woman') }}</a-radio>\r\n              <a-radio :value=\"3\">{{ $t('user.other') }}</a-radio>\r\n            </a-radio-group>\r\n          </a-form-item>\r\n\r\n          <a-form-item\r\n            :label-col=\"labelCol\"\r\n            :wrapper-col=\"wrapperCol\"\r\n            :label=\"$t('user.nickname')\"\r\n          >\r\n            <a-input\r\n              :placeholder=\"$t('user.innickname')\"\r\n              name=\"nickname\"\r\n              v-model=\"oldUserInfo.nickname\"\r\n            />\r\n          </a-form-item>\r\n          <a-form-item\r\n            :label-col=\"labelCol\"\r\n            :wrapper-col=\"wrapperCol\"\r\n            :label=\"$t('user.phone')\"\r\n          >\r\n            <a-input-group>\r\n              <a-row :gutter=\"8\">\r\n                <a-col :span=\"4\">\r\n                  <a-input\r\n                    v-model=\"oldUserInfo.international\"\r\n                    :placeholder=\"$t('common.international')\"\r\n                  />\r\n                </a-col>\r\n                <a-col :span=\"20\">\r\n                  <a-input\r\n                    :placeholder=\"$t('user.inphone')\"\r\n                    v-model=\"oldUserInfo.phone\"\r\n                  />\r\n                </a-col>\r\n              </a-row>\r\n            </a-input-group>\r\n          </a-form-item>\r\n          <a-form-item :wrapperCol=\"{ span: 24 }\" style=\"text-align: center\">\r\n            <a-button :loading=\"loading\" @click=\"handleSubmit\" type=\"primary\">{{\r\n              $t('common.save')\r\n            }}</a-button>\r\n            <a-button style=\"margin-left: 8px\" @click=\"handleLogout\">{{\r\n              $t('user.Logout')\r\n            }}</a-button>\r\n          </a-form-item>\r\n        </a-form>\r\n      </a-card>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapActions, mapState } from 'vuex'\r\nimport {\r\n  checkUsernameIsHave,\r\n  changeUsername,\r\n  getUserInfo\r\n} from '@/api/login.js'\r\nimport moment from 'moment'\r\nimport { log } from 'util'\r\nimport { Switch, List } from 'ant-design-vue'\r\nimport OtherLogin from \"./OtherLogin\"\r\nexport default {\r\n  components: {\r\n    OtherLogin,\r\n  },\r\n  computed: {\r\n    // 获取到用户信息\r\n    ...mapState({\r\n      userInfo: state => state.user.info\r\n    })\r\n  },\r\n  data() {\r\n    return {\r\n      loading: false,\r\n      moment,\r\n      labelCol: {\r\n        xs: { span: 24 },\r\n        sm: { span: 4 }\r\n      },\r\n      wrapperCol: {\r\n        xs: { span: 24 },\r\n        sm: { span: 20 }\r\n      },\r\n      oldUserInfo: {}\r\n    }\r\n  },\r\n  methods: {\r\n    ...mapActions(['SetToken', 'SetUserInfo']),\r\n    onTimeChange(date) {\r\n      this.oldUserInfo.birthday = moment(date).format('L')\r\n    },\r\n    async handleSubmit(e) {\r\n      const postData = JSON.parse(JSON.stringify(this.oldUserInfo))\r\n      if (postData.phone != '') {\r\n         postData.phone = postData.international + '-' + postData.phone\r\n      }\r\n      //检查手机号码是否正确\r\n      var regex = /^\\+((?:9[679]|8[035789]|6[789]|5[90]|42|3[578]|2[1-689])|9[0-58]|8[1246]|6[0-6]|5[1-8]|4[013-9]|3[0-469]|2[70]|7|1)(?:\\W*\\d){0,13}\\d$/\r\n      if (postData.phone != '' && !regex.test(postData.phone)) {\r\n        this.$message.error(this.$t('user.errorphone'))\r\n      } else {\r\n        const { birthday, sex, id, phone, nickname } = postData\r\n        this.loading = true\r\n        let res = await changeUsername({ birthday, sex, phone, nickname }, id)\r\n        this.loading = false\r\n        if (res.state) {\r\n          this.SetToken(res.body)\r\n          getUserInfo().then(res => {\r\n            if (res.state) {\r\n              this.SetUserInfo(res.body)\r\n              this.oldUserInfo = res.body\r\n            }\r\n          })\r\n          this.$router.push({\r\n            name: 'apps',\r\n            params: { id: this.userInfo.id }\r\n          })\r\n        } else {\r\n          this.$message.error(res.body)\r\n        }\r\n      }\r\n    },\r\n    //退出登录\r\n    handleLogout() {\r\n      // 您确定要退出登录吗？\r\n      const _this = this\r\n      this.$confirm({\r\n        title: this.$t('common.youlayout'),\r\n        onOk() {\r\n          _this.SetToken(null)\r\n          _this.SetUserInfo(null)\r\n          _this.$router.push({ name: 'index' })\r\n        }\r\n      })\r\n    }\r\n  },\r\n  created() {\r\n    const data = JSON.parse(JSON.stringify(this.$store.getters.userInfo))\r\n    if (data.birthday == 'null') {\r\n      data.birthday = null\r\n    }\r\n    let Mlang = (navigator.language || navigator.browserLanguage).toLowerCase()\r\n    if (!data.sex) {\r\n      data.sex = 2\r\n    }\r\n\r\n    if (data.phone) {\r\n      const list = data.phone.split('-')\r\n      if (list.length == 1) {\r\n        data.international = ''\r\n        data.phone = list[0]\r\n      } else {\r\n        data.international = list[0]\r\n        data.phone = list[1]\r\n      }\r\n    } else {\r\n      let Mlang = (\r\n        navigator.language || navigator.browserLanguage\r\n      ).toLowerCase() \r\n      switch (Mlang) {\r\n        case 'zh-cn':\r\n          data.international = '+86'\r\n          break\r\n        case 'ko':\r\n          data.international = '+82'\r\n          break\r\n        case 'en':\r\n          data.international = '+44'\r\n          break\r\n        default:\r\n          data.international = '+'\r\n          break\r\n      }\r\n    }\r\n    this.oldUserInfo = data\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.user-settings-info-view {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  .content {\r\n    /deep/.ant-form-item-label label {\r\n      color: #9d9d9e;\r\n    }\r\n    .ant-input {\r\n      color: #9d9d9e;\r\n      border-radius: 4px;\r\n      background: #f4f4f4;\r\n      &:focus {\r\n        background: #fff;\r\n      }\r\n    }\r\n    .p-user {\r\n      font-size: 16px !important;\r\n      font-weight: 400 !important;\r\n      line-height: 22px !important;\r\n      color: #454442 !important;\r\n    }\r\n    /deep/.ant-calendar-picker-input {\r\n      background: #f4f4f4;\r\n      color: #9d9d9e;\r\n      border-radius: 4px;\r\n      &:focus {\r\n        background: #fff;\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n"]}]}