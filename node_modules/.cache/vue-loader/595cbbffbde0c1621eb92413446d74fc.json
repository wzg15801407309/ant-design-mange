{"remainingRequest":"/Users/zhuqin.wei/Desktop/yhy/pangSky-console/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/zhuqin.wei/Desktop/yhy/pangSky-console/src/components/layouts/AvatarModal.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/zhuqin.wei/Desktop/yhy/pangSky-console/src/components/layouts/AvatarModal.vue","mtime":1581057012322},{"path":"/Users/zhuqin.wei/Desktop/yhy/pangSky-console/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhuqin.wei/Desktop/yhy/pangSky-console/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/zhuqin.wei/Desktop/yhy/pangSky-console/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhuqin.wei/Desktop/yhy/pangSky-console/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport { VueCropper } from 'vue-cropper'\r\nimport { putFile } from '@/api/upload.js'\r\nexport default {\r\n\tcomponents: {\r\n\t\tVueCropper\r\n\t},\r\n\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tvisible: false,\r\n\t\t\tid: null,\r\n\t\t\tconfirmLoading: false,\r\n\t\t\tpreviews: {},\r\n\t\t\theadImg: '',\r\n\t\t\t//剪切图片上传\r\n\t\t\tcrap: false,\r\n\t\t\toption: {\r\n\t\t\t\timg: '',\r\n\t\t\t\toutputSize: 1, //剪切后的图片质量（0.1-1）\r\n\t\t\t\tfull: false, //输出原图比例截图 props名full\r\n\t\t\t\toutputType: 'png',\r\n\t\t\t\tcanMove: true,\r\n\t\t\t\toriginal: false,\r\n\t\t\t\tcanMoveBox: true,\r\n\t\t\t\tautoCrop: true,\r\n\t\t\t\tautoCropWidth: 150,\r\n\t\t\t\tautoCropHeight: 150,\r\n\t\t\t\tfixedBox: false\r\n\t\t\t},\r\n\t\t\tfileName: '', //本机文件地址\r\n\t\t\tdownImg: '#',\r\n\t\t\timgFile: '',\r\n\t\t\tuploadImgRelaPath: '' //上传后的图片的地址（不带服务器域名）\r\n\t\t}\r\n\t},\r\n\tmethods: {\r\n\t\tedit(id) {\r\n\t\t\tthis.visible = true\r\n\t\t\tthis.id = id\r\n\t\t\t/* 获取原始头像 */ \r\n\t\t},\r\n\t\tclose() {\r\n\t\t\tthis.id = null\r\n\t\t\tthis.visible = false\r\n\t\t},\r\n\t\tcancelHandel() {\r\n\t\t\tthis.close()\r\n\t\t},\r\n\t\tokHandel() {\r\n\t\t\tconst vm = this\r\n\t\t\tvm.confirmLoading = true\r\n\t\t\tthis.finish('blob')\r\n\t\t\tvm.confirmLoading = false\r\n\t\t\tvm.close()\r\n\t\t\tvm.$message.success('上传成功')\r\n\t\t},\r\n\t\t//上传图片（点击上传按钮）\r\n\t\tfinish(type) {\r\n\t\t\tlet _this = this\r\n\t\t\tlet formData = new FormData()\r\n\t\t\t// 输出\r\n\t\t\tif (type === 'blob') {\r\n\t\t\t\tthis.$refs.cropper.getCropBlob(data => {\r\n\t\t\t\t\tlet img = window.URL.createObjectURL(data) \r\n\t\t\t\t\tthis.model = true\r\n\t\t\t\t\tthis.modelSrc = img\r\n\t\t\t\t\tformData.append('file', data, this.fileName)\r\n\t\t\t\t\tputFile(formData).then(res => { \r\n\t\t\t\t\t\tlet currimageUrl = process.env.VUE_APP_IMGUP_URL + res.file \r\n\t\t\t\t\t\tthis.$emit('changeImgUrl', currimageUrl)\r\n\t\t\t\t\t})\r\n\t\t\t\t})\r\n\t\t\t} else {\r\n\t\t\t\tthis.$refs.cropper.getCropData(data => {\r\n\t\t\t\t\tthis.model = true\r\n\t\t\t\t\tthis.modelSrc = data\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t},\r\n\t\t// 实时预览函数\r\n\t\trealTime(data) { \r\n\t\t\tthis.previews = data\r\n\t\t},\r\n\t\t//选择本地图片\r\n\t\tuploadImg(e, num) { \r\n\t\t\tvar _this = this\r\n\t\t\t//上传图片\r\n\t\t\tvar file = e.target.files[0]\r\n\t\t\t_this.fileName = file.name\r\n\t\t\tif (!/\\.(gif|jpg|jpeg|png|bmp|GIF|JPG|PNG)$/.test(e.target.value)) {\r\n\t\t\t\talert('图片类型必须是.gif,jpeg,jpg,png,bmp中的一种')\r\n\t\t\t\treturn false\r\n\t\t\t}\r\n\t\t\tvar reader = new FileReader()\r\n\t\t\treader.onload = e => {\r\n\t\t\t\tlet data\r\n\t\t\t\tif (typeof e.target.result === 'object') {\r\n\t\t\t\t\t// 把Array Buffer转化为blob 如果是base64不需要\r\n\t\t\t\t\tdata = window.URL.createObjectURL(new Blob([e.target.result]))\r\n\t\t\t\t} else {\r\n\t\t\t\t\tdata = e.target.result\r\n\t\t\t\t}\r\n\t\t\t\tif (num === 1) {\r\n\t\t\t\t\t_this.option.img = data\r\n\t\t\t\t} else if (num === 2) {\r\n\t\t\t\t\t_this.example2.img = data\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t// 转化为base64\r\n\t\t\t// reader.readAsDataURL(file)\r\n\t\t\t// 转化为blob\r\n\t\t\treader.readAsArrayBuffer(file)\r\n\t\t},\r\n\t\timgLoad(msg) { \r\n\t\t}\r\n\t}\r\n}\r\n",{"version":3,"sources":["AvatarModal.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"AvatarModal.vue","sourceRoot":"src/components/layouts","sourcesContent":["<template>\r\n\t<a-modal\r\n\t\t:title=\"$t('user.modifyingHead')\"\r\n\t\t:visible=\"visible\"\r\n\t\t:maskClosable=\"false\"\r\n\t\t:confirmLoading=\"confirmLoading\"\r\n\t\t:width=\"800\"\r\n\t\t@cancel=\"cancelHandel\"\r\n\t>\r\n\t\t<a-row>\r\n\t\t\t<a-col :xs=\"24\" :md=\"12\" :style=\"{ height: '350px' }\">\r\n\t\t\t\t<!-- 上传本地图片 -->\r\n\t\t\t\t<label class=\"btn btn-orange\" for=\"uploads\" style=\"\"\r\n\t\t\t\t\t><a-icon type=\"upload\" style=\"margin-right: 5px;\" />{{\r\n\t\t\t\t\t\t$t('user.chooseLocalpicture')\r\n\t\t\t\t\t}}</label\r\n\t\t\t\t>\r\n\t\t\t\t<input\r\n\t\t\t\t\ttype=\"file\"\r\n\t\t\t\t\tid=\"uploads\"\r\n\t\t\t\t\t:value=\"imgFile\"\r\n\t\t\t\t\tstyle=\"position:absolute; clip:rect(0 0 0 0);\"\r\n\t\t\t\t\taccept=\"image/png, image/jpeg, image/gif, image/jpg\"\r\n\t\t\t\t\t@change=\"uploadImg($event, 1)\"\r\n\t\t\t\t/>\r\n\t\t\t\t<div class=\"cropper\">\r\n\t\t\t\t\t<vueCropper\r\n\t\t\t\t\t\tref=\"cropper\"\r\n\t\t\t\t\t\t:img=\"option.img\"\r\n\t\t\t\t\t\t:outputSize=\"option.size\"\r\n\t\t\t\t\t\t:outputType=\"option.outputType\"\r\n\t\t\t\t\t\t:info=\"true\"\r\n\t\t\t\t\t\t:full=\"option.full\"\r\n\t\t\t\t\t\t:canMove=\"option.canMove\"\r\n\t\t\t\t\t\t:canMoveBox=\"option.canMoveBox\"\r\n\t\t\t\t\t\t:original=\"option.original\"\r\n\t\t\t\t\t\t:autoCrop=\"option.autoCrop\"\r\n\t\t\t\t\t\t:autoCropWidth=\"option.autoCropWidth\"\r\n\t\t\t\t\t\t:autoCropHeight=\"option.autoCropHeight\"\r\n\t\t\t\t\t\t:fixedBox=\"option.fixedBox\"\r\n\t\t\t\t\t\t@realTime=\"realTime\"\r\n\t\t\t\t\t\t@imgLoad=\"imgLoad\"\r\n\t\t\t\t\t></vueCropper>\r\n\t\t\t\t</div>\r\n\t\t\t</a-col>\r\n\t\t\t<a-col :xs=\"24\" :md=\"12\" :style=\"{ height: '350px' }\">\r\n\t\t\t\t<div class=\"show-preview\">\r\n\t\t\t\t\t<div :style=\"previews.div\" class=\"preview\">\r\n\t\t\t\t\t\t<img :src=\"previews.url\" :style=\"previews.img\" />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</a-col>\r\n\t\t</a-row>\r\n\t\t<template slot=\"footer\">\r\n\t\t\t<a-button key=\"back\" @click=\"cancelHandel\">{{\r\n\t\t\t\t$t('common.cancel')\r\n\t\t\t}}</a-button>\r\n\t\t\t<a-button\r\n\t\t\t\tkey=\"submit\"\r\n\t\t\t\ttype=\"primary\"\r\n\t\t\t\t:loading=\"confirmLoading\"\r\n\t\t\t\t@click=\"okHandel\"\r\n\t\t\t\t>{{ $t('common.save') }}</a-button\r\n\t\t\t>\r\n\t\t</template>\r\n\t</a-modal>\r\n</template>\r\n<script>\r\nimport { VueCropper } from 'vue-cropper'\r\nimport { putFile } from '@/api/upload.js'\r\nexport default {\r\n\tcomponents: {\r\n\t\tVueCropper\r\n\t},\r\n\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tvisible: false,\r\n\t\t\tid: null,\r\n\t\t\tconfirmLoading: false,\r\n\t\t\tpreviews: {},\r\n\t\t\theadImg: '',\r\n\t\t\t//剪切图片上传\r\n\t\t\tcrap: false,\r\n\t\t\toption: {\r\n\t\t\t\timg: '',\r\n\t\t\t\toutputSize: 1, //剪切后的图片质量（0.1-1）\r\n\t\t\t\tfull: false, //输出原图比例截图 props名full\r\n\t\t\t\toutputType: 'png',\r\n\t\t\t\tcanMove: true,\r\n\t\t\t\toriginal: false,\r\n\t\t\t\tcanMoveBox: true,\r\n\t\t\t\tautoCrop: true,\r\n\t\t\t\tautoCropWidth: 150,\r\n\t\t\t\tautoCropHeight: 150,\r\n\t\t\t\tfixedBox: false\r\n\t\t\t},\r\n\t\t\tfileName: '', //本机文件地址\r\n\t\t\tdownImg: '#',\r\n\t\t\timgFile: '',\r\n\t\t\tuploadImgRelaPath: '' //上传后的图片的地址（不带服务器域名）\r\n\t\t}\r\n\t},\r\n\tmethods: {\r\n\t\tedit(id) {\r\n\t\t\tthis.visible = true\r\n\t\t\tthis.id = id\r\n\t\t\t/* 获取原始头像 */ \r\n\t\t},\r\n\t\tclose() {\r\n\t\t\tthis.id = null\r\n\t\t\tthis.visible = false\r\n\t\t},\r\n\t\tcancelHandel() {\r\n\t\t\tthis.close()\r\n\t\t},\r\n\t\tokHandel() {\r\n\t\t\tconst vm = this\r\n\t\t\tvm.confirmLoading = true\r\n\t\t\tthis.finish('blob')\r\n\t\t\tvm.confirmLoading = false\r\n\t\t\tvm.close()\r\n\t\t\tvm.$message.success('上传成功')\r\n\t\t},\r\n\t\t//上传图片（点击上传按钮）\r\n\t\tfinish(type) {\r\n\t\t\tlet _this = this\r\n\t\t\tlet formData = new FormData()\r\n\t\t\t// 输出\r\n\t\t\tif (type === 'blob') {\r\n\t\t\t\tthis.$refs.cropper.getCropBlob(data => {\r\n\t\t\t\t\tlet img = window.URL.createObjectURL(data) \r\n\t\t\t\t\tthis.model = true\r\n\t\t\t\t\tthis.modelSrc = img\r\n\t\t\t\t\tformData.append('file', data, this.fileName)\r\n\t\t\t\t\tputFile(formData).then(res => { \r\n\t\t\t\t\t\tlet currimageUrl = process.env.VUE_APP_IMGUP_URL + res.file \r\n\t\t\t\t\t\tthis.$emit('changeImgUrl', currimageUrl)\r\n\t\t\t\t\t})\r\n\t\t\t\t})\r\n\t\t\t} else {\r\n\t\t\t\tthis.$refs.cropper.getCropData(data => {\r\n\t\t\t\t\tthis.model = true\r\n\t\t\t\t\tthis.modelSrc = data\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t},\r\n\t\t// 实时预览函数\r\n\t\trealTime(data) { \r\n\t\t\tthis.previews = data\r\n\t\t},\r\n\t\t//选择本地图片\r\n\t\tuploadImg(e, num) { \r\n\t\t\tvar _this = this\r\n\t\t\t//上传图片\r\n\t\t\tvar file = e.target.files[0]\r\n\t\t\t_this.fileName = file.name\r\n\t\t\tif (!/\\.(gif|jpg|jpeg|png|bmp|GIF|JPG|PNG)$/.test(e.target.value)) {\r\n\t\t\t\talert('图片类型必须是.gif,jpeg,jpg,png,bmp中的一种')\r\n\t\t\t\treturn false\r\n\t\t\t}\r\n\t\t\tvar reader = new FileReader()\r\n\t\t\treader.onload = e => {\r\n\t\t\t\tlet data\r\n\t\t\t\tif (typeof e.target.result === 'object') {\r\n\t\t\t\t\t// 把Array Buffer转化为blob 如果是base64不需要\r\n\t\t\t\t\tdata = window.URL.createObjectURL(new Blob([e.target.result]))\r\n\t\t\t\t} else {\r\n\t\t\t\t\tdata = e.target.result\r\n\t\t\t\t}\r\n\t\t\t\tif (num === 1) {\r\n\t\t\t\t\t_this.option.img = data\r\n\t\t\t\t} else if (num === 2) {\r\n\t\t\t\t\t_this.example2.img = data\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t// 转化为base64\r\n\t\t\t// reader.readAsDataURL(file)\r\n\t\t\t// 转化为blob\r\n\t\t\treader.readAsArrayBuffer(file)\r\n\t\t},\r\n\t\timgLoad(msg) { \r\n\t\t}\r\n\t}\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.btn-orange {\r\n\tdisplay: inline-block;\r\n\ttext-align: center;\r\n\tline-height: 32px;\r\n\tborder: 1px solid #ddd;\r\n\tpadding: 0 15px;\r\n\tborder-radius: 4px;\r\n\tcursor: pointer;\r\n\t&:hover {\r\n\t\tcolor: #ff8212;\r\n\t\tborder-color: #ff8212;\r\n\t}\r\n}\r\n.cropper {\r\n\twidth: 90%;\r\n\theight: 250px;\r\n\tmargin-top: 40px;\r\n}\r\n.show-preview {\r\n\tdisplay: flex;\r\n\tjustify-content: center;\r\n\t-webkit-justify-content: center;\r\n\theight: 100%;\r\n\talign-items: center;\r\n\t.preview {\r\n\t\toverflow: hidden;\r\n\t\tborder-radius: 50%;\r\n\t\tborder: 1px solid #cccccc;\r\n\t\tbackground: #cccccc;\r\n\t}\r\n}\r\n</style>\r\n"]}]}